"""
Islamic Content Generator
Uses pre-defined authentic Islamic religious content in Arabic
"""

import random
import time
from logger_config import setup_logger

logger = setup_logger()

class IslamicContentGenerator:
    def __init__(self, api_key=None):
        """Initialize the content generator with comprehensive Islamic content"""
        # No API key needed for local content
        self.current_content_index = {
            "morning_azkar": 0,
            "evening_azkar": 0,
            "quran_verse": 0,
            "daily_hadith": 0,
            "daily_dua": 0,
            "daily_reminder": 0,
            "religious_post": 0,
            "companion_story": 0
        }
        
        # Comprehensive authentic Islamic content in Arabic
        self.islamic_content = {
            "morning_azkar": [
                "🌅 أذكار الصباح الكاملة - المجموعة الأولى\n\n1️⃣ أصبحنا وأصبح الملك لله، والحمد لله، لا إله إلا الله وحده لا شريك له، له الملك وله الحمد وهو على كل شيء قدير (3 مرات)\n\n2️⃣ اللهم بك أصبحنا وبك أمسينا وبك نحيا وبك نموت وإليك النشور\n\n3️⃣ اللهم أعني على ذكرك وشكرك وحسن عبادتك (3 مرات)\n\n4️⃣ اللهم إني أسألك العفو والعافية في الدنيا والآخرة\n\n5️⃣ بسم الله الذي لا يضر مع اسمه شيء في الأرض ولا في السماء وهو السميع العليم (3 مرات)\n\n6️⃣ اللهم أنت ربي لا إله إلا أنت خلقتني وأنا عبدك وأنا على عهدك ووعدك ما استطعت أعوذ بك من شر ما صنعت أبوء لك بنعمتك علي وأبوء بذنبي فاغفر لي فإنه لا يغفر الذنوب إلا أنت\n\n🤲 ابدأ يومك بهذه الأذكار المباركة",
                
                "🌅 أذكار الصباح الكاملة - المجموعة الثانية\n\n1️⃣ آية الكرسي: الله لا إله إلا هو الحي القيوم لا تأخذه سنة ولا نوم له ما في السماوات وما في الأرض من ذا الذي يشفع عنده إلا بإذنه يعلم ما بين أيديهم وما خلفهم ولا يحيطون بشيء من علمه إلا بما شاء وسع كرسيه السماوات والأرض ولا يؤوده حفظهما وهو العلي العظيم\n\n2️⃣ قل هو الله أحد الله الصمد لم يلد ولم يولد ولم يكن له كفواً أحد (3 مرات)\n\n3️⃣ قل أعوذ برب الفلق من شر ما خلق ومن شر غاسق إذا وقب ومن شر النفاثات في العقد ومن شر حاسد إذا حسد (3 مرات)\n\n4️⃣ قل أعوذ برب الناس ملك الناس إله الناس من شر الوسواس الخناس الذي يوسوس في صدور الناس من الجنة والناس (3 مرات)\n\n✨ أذكار الحماية والبركة",
                
                "🌅 أذكار الصباح الكاملة - المجموعة الثالثة\n\n1️⃣ سبحان الله وبحمده (100 مرة)\n\n2️⃣ لا إله إلا الله وحده لا شريك له له الملك وله الحمد وهو على كل شيء قدير (100 مرة)\n\n3️⃣ استغفر الله العظيم الذي لا إله إلا هو الحي القيوم وأتوب إليه (100 مرة)\n\n4️⃣ سبحان الله والحمد لله ولا إله إلا الله والله أكبر (100 مرة)\n\n5️⃣ لا حول ولا قوة إلا بالله العلي العظيم (100 مرة)\n\n6️⃣ اللهم صل وسلم على نبينا محمد (100 مرة)\n\n🌟 أذكار التسبيح والحمد للصباح",
                
                "🌅 أذكار الصباح الكاملة - المجموعة الرابعة\n\n1️⃣ أعوذ بكلمات الله التامات من شر ما خلق (3 مرات)\n\n2️⃣ اللهم إني أعوذ بك من الهم والحزن والعجز والكسل والبخل والجبن وضلع الدين وغلبة الرجال\n\n3️⃣ اللهم إني أسألك من فضلك ورحمتك فإنه لا يملكها إلا أنت\n\n4️⃣ اللهم عافني في بدني اللهم عافني في سمعي اللهم عافني في بصري لا إله إلا أنت (3 مرات)\n\n5️⃣ اللهم أعوذ بك من الكفر والفقر وأعوذ بك من عذاب القبر لا إله إلا أنت (3 مرات)\n\n💫 أذكار الاستعاذة والدعاء",
                
                "🌅 أذكار الصباح الكاملة - المجموعة الخامسة\n\n1️⃣ اللهم ما أصبح بي من نعمة أو بأحد من خلقك فمنك وحدك لا شريك لك فلك الحمد ولك الشكر\n\n2️⃣ حسبي الله لا إله إلا هو عليه توكلت وهو رب العرش العظيم (7 مرات)\n\n3️⃣ بسم الله الرحمن الرحيم قل هو الله أحد الله الصمد لم يلد ولم يولد ولم يكن له كفواً أحد\n\n4️⃣ أستغفر الله ربي من كل ذنب وأتوب إليه\n\n5️⃣ الله أكبر كبيراً والحمد لله كثيراً وسبحان الله بكرة وأصيلاً (3 مرات)\n\n🌈 أذكار الحمد والتوكل",
                
                "🌅 أذكار الصباح من السنة النبوية\n\n📿 من قال حين يصبح:\n\n1️⃣ لا إله إلا الله وحده لا شريك له له الملك وله الحمد وهو على كل شيء قدير\n\n👑 كان له عدل عتق رقبة من ولد إسماعيل وكتب له عشر حسنات وحط عنه عشر سيئات ورفع له عشر درجات وكان في حرز من الشيطان حتى يمسي\n\n2️⃣ من قال: بسم الله الذي لا يضر مع اسمه شيء في الأرض ولا في السماء وهو السميع العليم (3 مرات)\n\n🛡️ لم يضره شيء حتى يمسي\n\n3️⃣ من قال سيد الاستغفار صباحاً:\n\n🌟 كان ضامناً على الله أن يدخله الجنة إن مات من يومه"
            ],
            
            "evening_azkar": [
                "🌙 أذكار المساء الكاملة - المجموعة الأولى\n\n1️⃣ أمسينا وأمسى الملك لله، والحمد لله، لا إله إلا الله وحده لا شريك له، له الملك وله الحمد وهو على كل شيء قدير (3 مرات)\n\n2️⃣ اللهم بك أمسينا وبك أصبحنا وبك نحيا وبك نموت وإليك المصير\n\n3️⃣ اللهم أعني على ذكرك وشكرك وحسن عبادتك (3 مرات)\n\n4️⃣ اللهم إني أسألك العفو والعافية في الدنيا والآخرة\n\n5️⃣ بسم الله الذي لا يضر مع اسمه شيء في الأرض ولا في السماء وهو السميع العليم (3 مرات)\n\n6️⃣ اللهم أنت ربي لا إله إلا أنت خلقتني وأنا عبدك وأنا على عهدك ووعدك ما استطعت أعوذ بك من شر ما صنعت أبوء لك بنعمتك علي وأبوء بذنبي فاغفر لي فإنه لا يغفر الذنوب إلا أنت\n\n🌌 اختتم يومك بهذه الأذكار المباركة",
                
                "🌙 أذكار المساء الكاملة - المجموعة الثانية\n\n1️⃣ آية الكرسي: الله لا إله إلا هو الحي القيوم لا تأخذه سنة ولا نوم له ما في السماوات وما في الأرض من ذا الذي يشفع عنده إلا بإذنه يعلم ما بين أيديهم وما خلفهم ولا يحيطون بشيء من علمه إلا بما شاء وسع كرسيه السماوات والأرض ولا يؤوده حفظهما وهو العلي العظيم\n\n2️⃣ قل هو الله أحد الله الصمد لم يلد ولم يولد ولم يكن له كفواً أحد (3 مرات)\n\n3️⃣ قل أعوذ برب الفلق من شر ما خلق ومن شر غاسق إذا وقب ومن شر النفاثات في العقد ومن شر حاسد إذا حسد (3 مرات)\n\n4️⃣ قل أعوذ برب الناس ملك الناس إله الناس من شر الوسواس الخناس الذي يوسوس في صدور الناس من الجنة والناس (3 مرات)\n\n💫 أذكار الحماية والاستعاذة",
                
                "🌙 أذكار المساء الكاملة - المجموعة الثالثة\n\n1️⃣ سبحان الله وبحمده (100 مرة)\n\n2️⃣ لا إله إلا الله وحده لا شريك له له الملك وله الحمد وهو على كل شيء قدير (100 مرة)\n\n3️⃣ استغفر الله العظيم الذي لا إله إلا هو الحي القيوم وأتوب إليه (100 مرة)\n\n4️⃣ سبحان الله والحمد لله ولا إله إلا الله والله أكبر (100 مرة)\n\n5️⃣ لا حول ولا قوة إلا بالله العلي العظيم (100 مرة)\n\n6️⃣ اللهم صل وسلم على نبينا محمد (100 مرة)\n\n✨ أذكار التسبيح والحمد للمساء",
                
                "🌙 أذكار المساء الكاملة - المجموعة الرابعة\n\n1️⃣ أعوذ بكلمات الله التامات من شر ما خلق (3 مرات)\n\n2️⃣ اللهم إني أعوذ بك من الهم والحزن والعجز والكسل والبخل والجبن وضلع الدين وغلبة الرجال\n\n3️⃣ اللهم إني أسألك من فضلك ورحمتك فإنه لا يملكها إلا أنت\n\n4️⃣ اللهم عافني في بدني اللهم عافني في سمعي اللهم عافني في بصري لا إله إلا أنت (3 مرات)\n\n5️⃣ اللهم أعوذ بك من الكفر والفقر وأعوذ بك من عذاب القبر لا إله إلا أنت (3 مرات)\n\n🌟 أذكار الاستعاذة والدعاء",
                
                "🌙 أذكار المساء الكاملة - المجموعة الخامسة\n\n1️⃣ اللهم ما أمسى بي من نعمة أو بأحد من خلقك فمنك وحدك لا شريك لك فلك الحمد ولك الشكر\n\n2️⃣ حسبي الله لا إله إلا هو عليه توكلت وهو رب العرش العظيم (7 مرات)\n\n3️⃣ بسم الله الرحمن الرحيم قل هو الله أحد الله الصمد لم يلد ولم يولد ولم يكن له كفواً أحد\n\n4️⃣ أستغفر الله ربي من كل ذنب وأتوب إليه\n\n5️⃣ الله أكبر كبيراً والحمد لله كثيراً وسبحان الله بكرة وأصيلاً (3 مرات)\n\n💎 أذكار الحمد والتوكل",
                
                "🌙 أذكار المساء من السنة النبوية\n\n📿 من قال حين يمسي:\n\n1️⃣ لا إله إلا الله وحده لا شريك له له الملك وله الحمد وهو على كل شيء قدير\n\n👑 كان له عدل عتق رقبة من ولد إسماعيل وكتب له عشر حسنات وحط عنه عشر سيئات ورفع له عشر درجات وكان في حرز من الشيطان حتى يصبح\n\n2️⃣ من قال: بسم الله الذي لا يضر مع اسمه شيء في الأرض ولا في السماء وهو السميع العليم (3 مرات)\n\n🛡️ لم يضره شيء حتى يصبح\n\n3️⃣ من قال سيد الاستغفار مساءً:\n\n🌟 كان ضامناً على الله أن يدخله الجنة إن مات من ليلته"
            ],
            
            "quran_verse": [
                "📖 آية من القرآن الكريم\n\n\"وَقُل رَّبِّ زِدْنِي عِلْماً\"\n(طه: 114)\n\n💡 اطلب من الله المزيد من العلم النافع",
                "📖 آية من القرآن الكريم\n\n\"وَمَن يَتَّقِ اللَّهَ يَجْعَل لَّهُ مَخْرَجاً\"\n(الطلاق: 2)\n\n🔓 التقوى مفتاح الفرج",
                "📖 آية من القرآن الكريم\n\n\"وَبَشِّرِ الصَّابِرِينَ\"\n(البقرة: 155)\n\n💪 الصبر مفتاح الفرج والنجاح",
                "📖 آية من القرآن الكريم\n\n\"إِنَّ مَعَ الْعُسْرِ يُسْراً\"\n(الشرح: 6)\n\n🌅 بعد كل ضيق يأتي الفرج"
            ],
            
            "daily_hadith": [
                "📚 حديث شريف\n\n\"إنما الأعمال بالنيات، وإنما لكل امرئ ما نوى\"\n(متفق عليه)\n\n💫 اجعل نيتك خالصة لله في كل عمل",
                "📚 حديث شريف\n\n\"من كان في حاجة أخيه كان الله في حاجته\"\n(متفق عليه)\n\n🤝 ساعد الناس يساعدك الله",
                "📚 حديث شريف\n\n\"الدال على الخير كفاعله\"\n(رواه مسلم)\n\n📢 انشر الخير تنل الأجر",
                "📚 حديث شريف\n\n\"من يسر على معسر يسر الله عليه في الدنيا والآخرة\"\n(رواه مسلم)\n\n💝 خفف عن الناس يخفف الله عنك",
                "📚 حديث شريف\n\n\"خير الناس أنفعهم للناس\"\n(رواه الطبراني)\n\n🌟 كن مفيداً للمجتمع",
                "📚 حديث شريف\n\n\"من صلى علي واحدة صلى الله عليه عشراً\"\n(رواه مسلم)\n\n🤲 أكثر من الصلاة على النبي",
                "📚 حديث شريف\n\n\"تبسمك في وجه أخيك صدقة\"\n(رواه الترمذي)\n\n😊 الابتسامة عبادة وأجر",
                "📚 حديث شريف\n\n\"من قال سبحان الله وبحمده مائة مرة حطت خطاياه\"\n(متفق عليه)\n\n✨ سبح الله واستغفره",
                "📚 حديث شريف\n\n\"لا يؤمن أحدكم حتى يحب لأخيه ما يحب لنفسه\"\n(متفق عليه)\n\n❤️ أحب الخير للآخرين",
                "📚 حديث شريف\n\n\"اتق الله حيثما كنت\"\n(رواه الترمذي)\n\n🎯 راقب الله في كل أحوالك",
                "📚 حديث شريف\n\n\"من قرأ القرآن فله بكل حرف حسنة\"\n(رواه الترمذي)\n\n📖 اقرأ القرآن واكسب الحسنات",
                "📚 حديث شريف\n\n\"المؤمن للمؤمن كالبنيان يشد بعضه بعضاً\"\n(متفق عليه)\n\n🤝 كن عوناً لإخوانك المؤمنين",
                "📚 حديث شريف\n\n\"من كذب علي متعمداً فليتبوأ مقعده من النار\"\n(متفق عليه)\n\n⚠️ احذر من الكذب خاصة في الدين",
                "📚 حديث شريف\n\n\"الطهور شطر الإيمان\"\n(رواه مسلم)\n\n💧 اهتم بالطهارة الجسدية والروحية",
                "📚 حديث شريف\n\n\"من توضأ فأحسن الوضوء خرجت خطاياه من جسده\"\n(رواه مسلم)\n\n🚿 أحسن وضوءك تنل المغفرة",
                "📚 حديث شريف\n\n\"أحب الأعمال إلى الله أدومها وإن قل\"\n(متفق عليه)\n\n🔄 المداومة على العمل الصالح أهم من الكثرة",
                "📚 حديث شريف\n\n\"من قام ليلة القدر إيماناً واحتساباً غفر له ما تقدم من ذنبه\"\n(متفق عليه)\n\n🌙 اغتنم الليالي المباركة",
                "📚 حديث شريف\n\n\"صوم يوم عرفة يكفر السنة الماضية والباقية\"\n(رواه مسلم)\n\n📅 لا تفوت صوم يوم عرفة",
                "📚 حديث شريف\n\n\"من صام رمضان إيماناً واحتساباً غفر له ما تقدم من ذنبه\"\n(متفق عليه)\n\n🌙 صوم رمضان بإيمان واحتساب",
                "📚 حديث شريف\n\n\"الصدقة تطفئ الخطيئة كما يطفئ الماء النار\"\n(رواه الترمذي)\n\n💰 تصدق تطفئ ذنوبك",
                "📚 حديث شريف\n\n\"من أكل طعاماً فقال الحمد لله غفر له ما تقدم من ذنبه\"\n(رواه الترمذي)\n\n🍽️ احمد الله بعد الطعام",
                "📚 حديث شريف\n\n\"البر حسن الخلق\"\n(رواه مسلم)\n\n🌟 حسن الخلق من أعظم البر",
                "📚 حديث شريف\n\n\"أثقل شيء في الميزان الخلق الحسن\"\n(رواه أبو داود)\n\n⚖️ حسن الخلق يثقل الميزان",
                "📚 حديث شريف\n\n\"من سلك طريقاً يلتمس فيه علماً سهل الله له طريقاً إلى الجنة\"\n(رواه مسلم)\n\n📚 اطلب العلم النافع",
                "📚 حديث شريف\n\n\"من دل على خير فله مثل أجر فاعله\"\n(رواه مسلم)\n\n📢 ادل الناس على الخير",
                "📚 حديث شريف\n\n\"كل معروف صدقة\"\n(متفق عليه)\n\n💝 كل عمل خير له أجر الصدقة",
                "📚 حديث شريف\n\n\"اللهم أعني على ذكرك وشكرك وحسن عبادتك\"\n(رواه أبو داود)\n\n🤲 ادع الله أن يعينك على العبادة",
                "📚 حديث شريف\n\n\"من استغفر للمؤمنين والمؤمنات كتب الله له بكل مؤمن ومؤمنة حسنة\"\n(رواه الطبراني)\n\n🌍 استغفر للمؤمنين جميعاً",
                "📚 حديث شريف\n\n\"إن الله يحب إذا عمل أحدكم عملاً أن يتقنه\"\n(رواه البيهقي)\n\n🎯 أتقن عملك يحبك الله",
                "📚 حديث شريف\n\n\"من قال لا إله إلا الله وحده لا شريك له كتب الله له ألف ألف حسنة\"\n(رواه النسائي)\n\n📿 أكثر من التهليل",
                "📚 حديث شريف\n\n\"من قال سبحان الله العظيم وبحمده غرست له نخلة في الجنة\"\n(رواه الترمذي)\n\n🌴 سبح الله واغرس نخلة في الجنة"
            ],
            
            "daily_dua": [
                "🤲 دعاء مستجاب\n\n\"اللهم اغفر لي ذنبي وخطئي وجهلي\"\n\n💝 ادع الله بصدق وانكسار",
                "🤲 دعاء مستجاب\n\n\"اللهم أصلح لي ديني وأصلح لي دنياي وأصلح لي آخرتي\"\n\n🌟 ادع الله بالخير الشامل",
                "🤲 دعاء مستجاب\n\n\"اللهم اهدني فيمن هديت وعافني فيمن عافيت\"\n\n✨ اطلب الهداية والعافية",
                "🤲 دعاء مستجاب\n\n\"ربنا آتنا في الدنيا حسنة وفي الآخرة حسنة وقنا عذاب النار\"\n\n🕌 الدعاء الجامع للخير"
            ],
            
            "daily_reminder": [
                "💭 تذكرة إيمانية\n\n\"وما خلقت الجن والإنس إلا ليعبدون\"\n\n🎯 تذكر الهدف من وجودك في هذه الحياة",
                "💭 تذكرة إيمانية\n\n\"الصلاة عماد الدين، من أقامها فقد أقام الدين\"\n\n🕌 حافظ على صلاتك في وقتها",
                "💭 تذكرة إيمانية\n\n\"بر الوالدين من أعظم الأعمال عند الله\"\n\n👥 أحسن إلى والديك",
                "💭 تذكرة إيمانية\n\n\"الصدقة تطفئ الخطيئة كما يطفئ الماء النار\"\n\n💰 تصدق ولو بالقليل"
            ],
            
            "religious_post": [
                "✨ بوست ديني\n\n🌙 في هدوء الليل وسكونه، تشع روحانية الذكر والدعاء. هذه اللحظات المباركة تقربنا من خالقنا، وتطهر قلوبنا من أدران الحياة.\n\n📿 اجعل من ليلك موعداً مع الله:\n• قراءة القرآن بتدبر\n• الاستغفار والتوبة\n• الدعاء بخشوع\n• الصلاة على النبي\n\n💎 فالليل خير جليس للمؤمن الصادق",
                
                "✨ بوست ديني\n\n🌅 مع إشراقة كل فجر جديد، يمنحنا الله فرصة ذهبية للبداية من جديد. كل يوم هو صفحة بيضاء نكتب فيها أعمالنا.\n\n🎯 اجعل يومك مليئاً بـ:\n• ذكر الله في كل وقت\n• العمل الصالح النافع\n• الإحسان إلى الناس\n• طلب العلم والحكمة\n\n🌟 فكل لحظة في حياتك أمانة ستُسأل عنها",
                
                "✨ بوست ديني\n\n💝 الصبر ليس مجرد انتظار، بل هو ثقة كاملة بحكمة الله وقدره. حين نصبر على البلاء، نكسب الأجر والثواب.\n\n🌈 ثمار الصبر:\n• تقوية الإيمان\n• تطهير النفس من الذنوب\n• نيل محبة الله ورضاه\n• البشارة بالجنة\n\n💪 فاصبر واحتسب، فإن بعد العسر يسراً",
                
                "✨ بوست ديني\n\n🤝 التواضع زينة المؤمن وعلامة صدق إيمانه. من تواضع لله رفعه، ومن تكبر وضعه.\n\n🌺 علامات التواضع:\n• احترام جميع الناس\n• قبول النصيحة بصدر رحب\n• عدم الاستكبار على الآخرين\n• الاعتراف بالخطأ\n\n👑 فالتواضع تاج على رؤوس الصالحين",
                
                "✨ بوست ديني\n\n💎 الدعاء هو صلة العبد بربه، وهو عبادة خالصة لله. في الدعاء نجد الراحة والطمأنينة والأمل.\n\n🤲 آداب الدعاء:\n• الطهارة والوضوء\n• الحمد والثناء على الله\n• الصلاة على النبي\n• الدعاء بخشوع وحضور قلب\n\n🌟 ادع الله وأنت موقن بالإجابة",
                
                "✨ بوست ديني\n\n📚 العلم الشرعي نور يضيء طريق المؤمن في هذه الحياة. من طلب العلم سهل الله له طريقاً إلى الجنة.\n\n🎓 فضائل طلب العلم:\n• رفعة الدرجات عند الله\n• الهداية إلى الطريق المستقيم\n• النفع للنفس والمجتمع\n• الأجر المستمر بعد الموت\n\n✨ فاطلب العلم من المهد إلى اللحد",
                
                "✨ بوست ديني\n\n🌙 قيام الليل شرف المؤمن ودليل صدق إيمانه. في جوف الليل يناجي العبد ربه بصدق وخشوع.\n\n🌟 فوائد قيام الليل:\n• تطهير القلب من الذنوب\n• تقوية الصلة بالله\n• نيل الشفاعة يوم القيامة\n• السكينة والطمأنينة\n\n💫 فاجعل لك نصيباً من قيام الليل",
                
                "✨ بوست ديني\n\n💰 الزكاة ليست مجرد إخراج مال، بل هي تطهير للنفس والمال. بالزكاة نحقق التكافل الاجتماعي.\n\n🌱 آثار الزكاة:\n• تطهير المال وتنميته\n• تقوية الروابط الاجتماعية\n• إدخال السرور على الفقراء\n• نيل البركة والرضا الإلهي\n\n🎯 فأخرج زكاتك بصدق وإخلاص",
                
                "✨ بوست ديني\n\n🕊️ التوبة باب رحمة الله المفتوح دائماً. مهما كثرت الذنوب، فإن رحمة الله أوسع وأعظم.\n\n🌸 شروط التوبة النصوح:\n• الندم على ما فات\n• الإقلاع عن الذنب فوراً\n• العزم على عدم العودة\n• رد الحقوق لأصحابها\n\n💎 فبادر بالتوبة قبل فوات الأوان",
                
                "✨ بوست ديني\n\n🌺 الأخلاق الحسنة هي زينة المؤمن في الدنيا والآخرة. بحسن الخلق نكسب محبة الناس ورضا الله.\n\n🌟 من الأخلاق الحميدة:\n• الصدق في القول والعمل\n• الوفاء بالعهود والوعود\n• الكرم والجود\n• الحلم والصبر\n\n👑 فتخلق بأخلاق الإسلام العظيمة"
            ],
            
            "companion_story": [
                "👤 قصة صحابي - أبو بكر الصديق رضي الله عنه\n\n💎 الصاحب الأول والصديق الأعظم\n\nكان أبو بكر أول من آمن بالنبي ﷺ من الرجال، ولم يتردد لحظة واحدة. عندما سأله النبي عن الإسلام، قال: 'آمنت' دون تفكير.\n\n🌟 موقف مؤثر:\nفي الهجرة، اختبأ مع النبي في غار ثور. عندما اقترب المشركون، قال أبو بكر: 'لو نظر أحدهم تحت قدميه لرآنا!' فقال النبي: 'ما ظنك باثنين الله ثالثهما؟'\n\n💝 الدرس:\nالثقة الكاملة بالله تطرد الخوف والقلق. رفيق الصالحين نعمة عظيمة.",
                
                "👤 قصة صحابي - عمر بن الخطاب رضي الله عنه\n\n⚔️ الفاروق الذي فرق بين الحق والباطل\n\nكان عمر من أشد أعداء الإسلام، لكن الله هداه فأصبح من أعظم المدافعين عنه. دخل الإسلام بقوة وأعز الله به الدين.\n\n🌟 موقف مؤثر:\nلما تولى الخلافة، كان يتفقد الرعية بنفسه. ذات ليلة سمع بكاء أطفال من خيمة، فذهب ووجد أماً تطبخ الماء والحصى لتسكت أطفالها الجياع. فبكى عمر وحمل الطعام بنفسه إليها.\n\n💝 الدرس:\nالعدل والرحمة والمسؤولية أساس القيادة الناجحة. خدمة الناس شرف عظيم.",
                
                "👤 قصة صحابي - عثمان بن عفان رضي الله عنه\n\n💎 ذو النورين الذي تزوج ابنتي النبي\n\nكان عثمان كريماً جواداً، ينفق ماله في سبيل الله دون تردد. جهز جيش العسرة بماله كله حتى قال النبي: 'ما ضر عثمان ما عمل بعد اليوم'.\n\n🌟 موقف مؤثر:\nعندما حوصر في بيته، منع أصحابه من القتال دفاعاً عنه قائلاً: 'من كان محباً لي فليكفف يده ولا يقاتل'. فضل الشهادة على سفك دماء المسلمين.\n\n💝 الدرس:\nالكرم والجود من صفات المؤمنين. تجنب الفتنة أولى من الانتصار للنفس.",
                
                "👤 قصة صحابي - علي بن أبي طالب رضي الله عنه\n\n🦁 أسد الله الغالب وفارس الإسلام\n\nتربى في بيت النبوة، وكان أول من أسلم من الصبيان. اشتهر بشجاعته وعلمه وحكمته، وقال عنه النبي: 'علي مني وأنا من علي'.\n\n🌟 موقف مؤثر:\nليلة الهجرة، نام في فراش النبي ليوهم المشركين أن النبي ما زال في بيته، رغم خطر القتل. لم يتردد في التضحية بنفسه لحماية رسول الله.\n\n💝 الدرس:\nالشجاعة الحقيقية هي التضحية من أجل الحق. الولاء الصادق لا يتزعزع أمام المخاطر.",
                
                "👤 قصة صحابي - خالد بن الوليد رضي الله عنه\n\n⚔️ سيف الله المسلول الذي لم يُهزم\n\nكان قائداً عسكرياً فذاً، لم يخسر معركة واحدة في الجاهلية والإسلام. أسلم بعد صلح الحديبية وأصبح من أعظم فرسان الإسلام.\n\n🌟 موقف مؤثر:\nفي معركة مؤتة، تولى القيادة بعد استشهاد القادة الثلاثة. نظم انسحاباً تكتيكياً أنقذ الجيش من الإبادة، وقال النبي: 'أخذ الراية سيف من سيوف الله'.\n\n💝 الدرس:\nالحكمة في القيادة أهم من الشجاعة. أحياناً الانسحاب التكتيكي انتصار استراتيجي.",
                
                "👤 قصة صحابي - سعد بن أبي وقاص رضي الله عنه\n\n🏹 البطل المجاب الدعوة\n\nكان من السابقين إلى الإسلام ومن المبشرين بالجنة. دعا له النبي: 'اللهم سدد رميته وأجب دعوته'، فكان مجاب الدعوة.\n\n🌟 موقف مؤثر:\nعندما أرادت أمه إجباره على ترك الإسلام بالامتناع عن الطعام، قال لها: 'يا أماه، لو كان لك مائة نفس تخرج واحدة بعد أخرى ما تركت ديني'. فأسلمت أمه بعدها.\n\n💝 الدرس:\nالثبات على الحق مهما كانت التضحيات. بر الوالدين لا يكون بمعصية الله.",
                
                "👤 قصة صحابي - أبو ذر الغفاري رضي الله عنه\n\n🌟 الصادق اللهجة الزاهد العابد\n\nكان مشهوراً بصدقه وزهده في الدنيا. قال عنه النبي: 'ما أقلت الغبراء ولا أظلت الخضراء على ذي لهجة أصدق من أبي ذر'.\n\n🌟 موقف مؤثر:\nرفض أن يكتنز الذهب والفضة، وكان يوزع كل ما يملك على الفقراء. عندما عوتب على ذلك، قال: 'كيف أكتنز وقد سمعت رسول الله يقول عن الكنز ما قال؟'\n\n💝 الدرس:\nالزهد في الدنيا يورث الغنى الحقيقي. العمل بالعلم أهم من مجرد العلم.",
                
                "👤 قصة صحابي - سلمان الفارسي رضي الله عنه\n\n🌍 الباحث عن الحق من بلاد فارس\n\nرحل من فارس باحثاً عن الدين الحق، وتنقل بين النصارى والرهبان حتى وصل للمدينة والتقى بالنبي. قال النبي: 'سلمان منا أهل البيت'.\n\n🌟 موقف مؤثر:\nفي غزوة الأحزاب، اقترح حفر الخندق حول المدينة، وهي خطة لم يعرفها العرب. كان يحفر مع الصحابة رغم أنه حر أصبح عبداً في طريقه للإسلام.\n\n💝 الدرس:\nالبحث عن الحق يستحق كل تضحية. الخبرة والعلم نعمة نشارك بها المجتمع.",
                
                "👤 قصة صحابي - عبد الله بن عمر رضي الله عنهما\n\n📚 العالم المتقي المتبع للسنة\n\nكان من أكثر الصحابة اتباعاً لسنة النبي، يحفظ كل تفصيلة من أفعاله وأقواله. عُرف بورعه وتقواه.\n\n🌟 موقف مؤثر:\nكان إذا سافر يتتبع الأماكن التي نزل فيها النبي، ويصلي حيث صلى، ويستظل حيث استظل. سُئل عن ذلك فقال: 'لعل رحمة تنزل فتصيبني'.\n\n💝 الدرس:\nمحبة النبي تظهر في اتباع سنته. التقوى والورع طريق السعادة الحقيقية.",
                
                "👤 قصة صحابي - أبو هريرة رضي الله عنه\n\n📚 حافظ السنة النبوية\n\nأسلم متأخراً لكنه لازم النبي ملازمة شديدة. روى أكثر من 5000 حديث، وكان مبارك الحفظ مجاب الدعوة.\n\n🌟 موقف مؤثر:\nدعا له النبي: 'اللهم حبب عبيدك هذا إلى عبادك المؤمنين وحببهم إليه'. كان يقول: 'ما من أحد أكثر حديثاً مني إلا عبد الله بن عمرو، فإنه كان يكتب وأنا لا أكتب'.\n\n💝 الدرس:\nحفظ العلم والسنة خدمة جليلة للأمة. التواضع مع العلم زينة العالم."
            ]
        }
    
    def test_connection(self):
        """Test content generator (always successful since using local content)"""
        try:
            logger.info("🔍 Testing content generator...")
            # Test that we have content available
            if all(len(content_list) > 0 for content_list in self.islamic_content.values()):
                logger.info("✅ Content generator ready with pre-defined Islamic content")
                return True
            else:
                logger.error("❌ No content available")
                return False
        except Exception as e:
            logger.error(f"❌ Content generator test failed: {e}")
            return False
    
    def generate_content(self, content_type, retry_count=0):
        """Generate Islamic content based on the specified type"""
        if content_type not in self.islamic_content:
            logger.error(f"❌ Unknown content type: {content_type}")
            return None
        
        try:
            logger.info(f"🤖 Selecting {content_type} content...")
            
            # Get the content list for this type
            content_list = self.islamic_content[content_type]
            current_index = self.current_content_index[content_type]
            
            # Select content (cycle through available content)
            selected_content = content_list[current_index % len(content_list)]
            
            # Update index for next time
            self.current_content_index[content_type] = (current_index + 1) % len(content_list)
            
            # Return content without watermark
            formatted_content = selected_content
            
            logger.info(f"✅ Successfully selected {content_type} content")
            logger.debug(f"Selected content preview: {selected_content[:100]}...")
            
            return formatted_content
            
        except Exception as e:
            logger.error(f"❌ Error selecting {content_type} content: {e}")
            return self._get_fallback_content(content_type)
    
    def _get_fallback_content(self, content_type):
        """Provide fallback content when content selection fails"""
        # Use the first item from our content lists as fallback
        if content_type in self.islamic_content and len(self.islamic_content[content_type]) > 0:
            return self.islamic_content[content_type][0]
        
        # Ultimate fallback
        return "🤲 اذكر الله كثيراً\n\n\"سبحان الله وبحمده سبحان الله العظيم\""
